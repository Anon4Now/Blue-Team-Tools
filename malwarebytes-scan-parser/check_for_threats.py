class CheckForThreats:
    keyTup = ('processes', 'modules', 'folders', 'sectors', 'keys', 'datas', 'files', 'values')

    def __init__(self, xmlContent):
        self.checkListLength = []
        self.xmlContent = xmlContent
        self.numberDict = {}
        self.childDict = {}

        for child in xmlContent[5]:
            self.checkListLength.append(child)

        for child in xmlContent[3]:
            self.numberDict[child.tag] = child.text

    def findNumber(self):
        for key, value in self.numberDict.items():
            if key in CheckForThreats.keyTup and '0' < value <= '1':
                self.childDict[key] = value

            if key in CheckForThreats.keyTup and value > '1':
                self.childDict[key] = value

    def findThreats(self):
        checkList = len(self.checkListLength)
        startPos = 0
        if checkList > 0:
            print("\n[!] THREATS DETECTED -- please review the below items...")
            for key, val in self.childDict.items():
                print(f'\n[-] {key.upper()} ({val}):')
                endPos = int(val) + startPos
                for x in range(startPos, endPos):
                    startPos = endPos
                    for child in self.xmlContent[5][x]:
                        print(f'    {child.text}')
        else:
            print(f'\n[+] All items scanned successfully, no threats detected...')

    def run(self):
        self.findNumber()
        self.findThreats()
