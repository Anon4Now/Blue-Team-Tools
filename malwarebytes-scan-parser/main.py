from get_xml_data import GetXMLData
from compare_dates import CompareDates
from check_for_threats import CheckForThreats

if __name__ == '__main__':
    filePath = input("[+] Please specify the path to the MBBR-STDOUT file... >> ")
    getXmlData = GetXMLData()

    # print the dates for the databases
    compareDates = CompareDates(getXmlData.readFile(filePath))
    dbDates = compareDates.runDateCheck()
    print("\n---------------------------------------------------------------------------------")
    print("---------------------------------------------------------------------------------")
    for key, date in dbDates.items():

        if date:
            print(f'[-] The {key} is {date} days old, considering updating...')
        else:
            print(f'[+] The {key} is up to date...')

    # check to see if threats are present in output
    checkThreats = CheckForThreats(getXmlData.readFile(filePath))
    checkThreats.run()
